<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Horario Semanal de Operadores</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    h1 { margin-bottom: .5rem; }
    .controls { margin-bottom: 1rem; }
    .controls button, .controls input { margin-right: .5rem; }
    table { border-collapse: collapse; width: 100%; max-width: 800px; }
    th, td { border: 1px solid #ccc; padding: 4px 8px; text-align: center; }
    th { background: #f0f0f0; }
    .rest { background: #f88; }
    .work { background: #8f8; }
  </style>
</head>
<body>
  <h1>Horario Semanal de Operadores (Visualización)</h1>
  <div class="controls">
    <button id="prev">« Semana anterior</button>
    <button id="next">Semana siguiente »</button>
    <label>
      Fecha (cualquier día):
      <input type="date" id="weekInput" />
    </label>
    <button id="load">Cargar semana</button>
  </div>
  <div id="schedule"></div>
  <script>
    // Patrón fijo de turnos: 1=trabajo, 0=descanso (lunes a sábado)
    const baseSchedule = [
      [1,1,1,1,0,0], [1,1,0,0,1,1], [0,0,1,1,1,1], [1,1,1,0,0,1],
      [0,1,1,1,1,0], [1,0,0,1,1,1], [1,1,1,0,0,1], [0,0,1,1,1,1],
      [1,1,0,1,1,0], [0,1,1,0,1,1]
    ];
    const names = [
     "Eduardo","Gabriel","Rebeca","David",
      "Enrique","Mariel","René","Josué","Heidi",  "Ruben"    ];
    // Calcula el lunes de la semana de la fecha dada
    function getMonday(d) {
      const date = new Date(d);
      const day = date.getDay();
      const diff = (day + 6) % 7;
      date.setDate(date.getDate() - diff);
      return date;
    }
    // Índice de semanas desde base 2025-06-30
    function weekIndex(monday) {
      const base = new Date('2025-06-30');
      const diffMs = monday - getMonday(base);
      return Math.floor(diffMs / (7*24*60*60*1000));
    }
    // Renderiza la semana dada
    function renderWeek(monday) {
      const container = document.getElementById('schedule');
      container.innerHTML = '';
      const idx = weekIndex(monday);
      const rot = ((idx % names.length) + names.length) % names.length;
      const order = names.slice(rot).concat(names.slice(0,rot));
      // Construir tabla
      const tbl = document.createElement('table');
      // Encabezados
      const dates = [];
      for (let i=0; i<7; i++) {
        const d = new Date(monday);
        d.setDate(d.getDate() + i);
        dates.push(d);
      }
      const thead = document.createElement('thead');
      let hdr = '<tr><th>Operador</th>';
      dates.forEach((d,i) => {
        const labels = ['Lun','Mar','Mié','Jue','Vie','Sáb','Dom'];
        hdr += `<th>${labels[i]}<br>${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}</th>`;
      });
      hdr += '<th>Hrs</th></tr>';
      thead.innerHTML = hdr;
      tbl.appendChild(thead);
      // Cuerpo
      const tbody = document.createElement('tbody');
      order.forEach((name,i) => {
        let hrs = 0;
        const row = document.createElement('tr');
        row.innerHTML = `<td>${name}</td>`;
        for (let d=0; d<7; d++) {
          const isWork = d<6 ? baseSchedule[i][d] === 1 : false;
          const cls = isWork ? 'work' : 'rest';
          const text = isWork ? 'Turno' : 'Descanso';
          if (isWork) hrs += 12;
          row.innerHTML += `<td class="${cls}">${text}</td>`;
        }
        row.innerHTML += `<td>${hrs}</td>`;
        tbody.appendChild(row);
      });
      tbl.appendChild(tbody);
      container.appendChild(tbl);
    }
    // UI
    let currentMonday;
    document.getElementById('prev').onclick = () => { currentMonday.setDate(currentMonday.getDate()-7); updateUI(); };
    document.getElementById('next').onclick = () => { currentMonday.setDate(currentMonday.getDate()+7); updateUI(); };
    document.getElementById('load').onclick = () => {
      const val = document.getElementById('weekInput').value;
      if (!val) return;
      currentMonday = getMonday(new Date(val));
      updateUI();
    };
    function updateUI() {
      document.getElementById('weekInput').value = currentMonday.toISOString().slice(0,10);
      renderWeek(currentMonday);
    }
    window.addEventListener('DOMContentLoaded', () => {
      currentMonday = getMonday(new Date());
      updateUI();
    });
  </script>
</body>
</html>
